{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/fa059086/Projects/Decentralized_OSN/pages/posts/[postid].js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport { withRouter } from \"next/router\";\nimport React, { Component } from \"react\";\nimport ipfs from \"../../ethereum/ipfs\";\nimport { web3, metamask_provider } from \"../../ethereum/web3\";\nimport PostFactory from \"../../ethereum/factory\";\nimport ZoomedImage from \"../../componenets/ZoomedImage/ZoomedImage\";\nimport PostContract from \"../../ethereum/build/Post.json\";\nimport Head from \"next/head\";\nimport FullPost from \"../../componenets/FullPost/FullPost\";\nimport DonateCard from \"../../componenets/DonateCard/DonateCard\";\nimport MetamaskCard from \"../../componenets/MetamaskCard/MetamaskCard\";\nimport Navbar from \"../../componenets/Navbar/Navbar\";\nvar accounts = [];\n\nvar Post = /*#__PURE__*/function (_Component) {\n  _inherits(Post, _Component);\n\n  var _super = _createSuper(Post);\n\n  function Post(props) {\n    var _this;\n\n    _classCallCheck(this, Post);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"takeback\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        metamask: true,\n        is_donate: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"imageZoom\", /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.preventDefault();\n                event.stopPropagation();\n                console.log(_this.state.imageUrl);\n\n                if (_this.state.zoomed !== null) {\n                  _this.setState({\n                    zoomed: null\n                  });\n                } else {\n                  _this.setState({\n                    zoomed: \"https://ipfs.io/ipfs/\".concat(_this.state.imageUrl)\n                  });\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"readContent\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        comment_content: event.target.value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"toggleCommentView\", /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event) {\n        var post_address, _Post4, comments_address, comments;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                if (_this.state.hideComments) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                _this.setState({\n                  hideComments: true\n                });\n\n                _context3.next = 13;\n                break;\n\n              case 4:\n                post_address = \"0x\" + _this.state.address;\n                _Post4 = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), post_address);\n                _context3.next = 8;\n                return _Post4.methods.getComments().call();\n\n              case 8:\n                comments_address = _context3.sent;\n                _context3.next = 11;\n                return function () {\n                  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(comments_address) {\n                    var new_comments, i, Comment, currentComment;\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            new_comments = [];\n                            i = 0;\n\n                          case 2:\n                            if (!(i < comments_address.length)) {\n                              _context2.next = 19;\n                              break;\n                            }\n\n                            Comment = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), comments_address[i]);\n                            _context2.t0 = comments_address[i];\n                            _context2.next = 7;\n                            return Comment.methods.image_hash().call();\n\n                          case 7:\n                            _context2.t1 = _context2.sent;\n                            _context2.next = 10;\n                            return Comment.methods.author().call();\n\n                          case 10:\n                            _context2.t2 = _context2.sent;\n                            _context2.next = 13;\n                            return Comment.methods.content().call();\n\n                          case 13:\n                            _context2.t3 = _context2.sent;\n                            currentComment = {\n                              address: _context2.t0,\n                              imageUrl: _context2.t1,\n                              author: _context2.t2,\n                              content: _context2.t3\n                            };\n                            new_comments.push(currentComment);\n\n                          case 16:\n                            i++;\n                            _context2.next = 2;\n                            break;\n\n                          case 19:\n                            return _context2.abrupt(\"return\", new_comments);\n\n                          case 20:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  }));\n\n                  return function (_x3) {\n                    return _ref3.apply(this, arguments);\n                  };\n                }()(comments_address);\n\n              case 11:\n                comments = _context3.sent;\n\n                _this.setState({\n                  comments: comments,\n                  hideComments: false\n                });\n\n              case 13:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"donate\", /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event) {\n        var tip;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                event.persist();\n                event.stopPropagation();\n                event.preventDefault();\n                _context4.next = 5;\n                return PostFactory.methods.min_contribution().call();\n\n              case 5:\n                tip = _context4.sent;\n                tip = web3.utils.fromWei(tip, \"ether\");\n\n                _this.setState({\n                  is_donate: true,\n                  min_tip: tip\n                });\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"captureFile\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var file = event.target.files[0];\n      var reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = function () {\n        _this.setState({\n          buffer: Buffer(reader.result)\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isdonatebuttonon\", function (event) {\n      event.preventDefault();\n      var new_value = true;\n\n      if (event.target.value >= _this.state.min_tip) {\n        new_value = false;\n      }\n\n      _this.setState({\n        value: event.target.value,\n        disable_transact_okay: new_value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"transact\", /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(event) {\n        var address, post;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                event.persist();\n                event.preventDefault();\n                _context5.next = 4;\n                return web3.eth.getAccounts();\n\n              case 4:\n                accounts = _context5.sent;\n\n                if (!(metamask_provider == false || accounts.length == 0)) {\n                  _context5.next = 9;\n                  break;\n                }\n\n                _this.setState({\n                  metamask: false,\n                  is_donate: false\n                });\n\n                _context5.next = 15;\n                break;\n\n              case 9:\n                _this.setState({\n                  metamask: true,\n                  donating: true\n                });\n\n                address = _this.state.address;\n                post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), address);\n                _context5.next = 14;\n                return post.methods.receiveContribution().send({\n                  from: accounts[0],\n                  value: web3.utils.toWei(_this.state.value, \"ether\")\n                });\n\n              case 14:\n                _this.setState({\n                  metamask: true,\n                  value: 0,\n                  is_donate: false,\n                  donating: false\n                });\n\n              case 15:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"postComment\", /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(event) {\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                event.persist();\n                event.preventDefault();\n                event.stopPropagation();\n                _context8.next = 5;\n                return web3.eth.getAccounts();\n\n              case 5:\n                accounts = _context8.sent;\n\n                if (metamask_provider == false || accounts.length == 0) {\n                  _this.setState({\n                    metamask: false\n                  });\n                } else {\n                  _this.setState({\n                    metamask: true,\n                    uploading: true\n                  });\n\n                  ipfs.files.add(_this.state.buffer, /*#__PURE__*/function () {\n                    var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(error, result) {\n                      var parent_address, parent_post, comments_address, comments, file_uploader;\n                      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                        while (1) {\n                          switch (_context7.prev = _context7.next) {\n                            case 0:\n                              if (!error) {\n                                _context7.next = 3;\n                                break;\n                              }\n\n                              console.error(error);\n                              return _context7.abrupt(\"return\");\n\n                            case 3:\n                              parent_address = \"0x\" + _this.state.address;\n                              _context7.next = 6;\n                              return PostFactory.methods.createComment(parent_address, result[0].hash, _this.state.comment_content).send({\n                                from: accounts[0]\n                              });\n\n                            case 6:\n                              parent_post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), parent_address);\n                              _context7.next = 9;\n                              return parent_post.methods.getComments().call();\n\n                            case 9:\n                              comments_address = _context7.sent;\n                              _context7.next = 12;\n                              return function () {\n                                var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(comments_address) {\n                                  var new_comments, i, Comment, currentComment;\n                                  return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                                    while (1) {\n                                      switch (_context6.prev = _context6.next) {\n                                        case 0:\n                                          new_comments = [];\n                                          i = 0;\n\n                                        case 2:\n                                          if (!(i < comments_address.length)) {\n                                            _context6.next = 18;\n                                            break;\n                                          }\n\n                                          Comment = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), comments_address[i]);\n                                          _context6.next = 6;\n                                          return Comment.methods.image_hash().call();\n\n                                        case 6:\n                                          _context6.t0 = _context6.sent;\n                                          _context6.next = 9;\n                                          return Comment.methods.author().call();\n\n                                        case 9:\n                                          _context6.t1 = _context6.sent;\n                                          _context6.next = 12;\n                                          return Comment.methods.content().call();\n\n                                        case 12:\n                                          _context6.t2 = _context6.sent;\n                                          currentComment = {\n                                            imageUrl: _context6.t0,\n                                            author: _context6.t1,\n                                            content: _context6.t2\n                                          };\n                                          new_comments.push(currentComment);\n\n                                        case 15:\n                                          i++;\n                                          _context6.next = 2;\n                                          break;\n\n                                        case 18:\n                                          return _context6.abrupt(\"return\", new_comments);\n\n                                        case 19:\n                                        case \"end\":\n                                          return _context6.stop();\n                                      }\n                                    }\n                                  }, _callee6);\n                                }));\n\n                                return function (_x9) {\n                                  return _ref8.apply(this, arguments);\n                                };\n                              }()(comments_address);\n\n                            case 12:\n                              comments = _context7.sent;\n\n                              _this.setState({\n                                comments: comments,\n                                comment_content: \"\",\n                                uploading: false\n                              });\n\n                              file_uploader = document.getElementById(\"file_upload_2\");\n                              file_uploader.value = \"\";\n\n                            case 16:\n                            case \"end\":\n                              return _context7.stop();\n                          }\n                        }\n                      }, _callee7);\n                    }));\n\n                    return function (_x7, _x8) {\n                      return _ref7.apply(this, arguments);\n                    };\n                  }());\n                }\n\n              case 7:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8);\n      }));\n\n      return function (_x6) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n\n    _this.state = {\n      author: null,\n      content: null,\n      imageUrl: null,\n      address: _this.props.address,\n      comments: [],\n      hideComments: true,\n      zoomed: null,\n      is_donate: false,\n      metamask: true,\n      min_tip: 0,\n      value: 0,\n      comment_content: \"\",\n      disable_transact_okay: true,\n      donating: false,\n      uploading: false\n    };\n    return _this;\n  }\n\n  _createClass(Post, [{\n    key: \"componentWillReceiveProps\",\n    value: function () {\n      var _componentWillReceiveProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(nextProps) {\n        var post_address, _Post2, author, content, imageUrl;\n\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                post_address = nextProps.address;\n                _Post2 = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), post_address);\n                _context9.next = 4;\n                return _Post2.methods.author().call();\n\n              case 4:\n                author = _context9.sent;\n                _context9.next = 7;\n                return _Post2.methods.content().call();\n\n              case 7:\n                content = _context9.sent;\n                _context9.next = 10;\n                return _Post2.methods.image_hash().call();\n\n              case 10:\n                imageUrl = _context9.sent;\n                this.setState({\n                  author: author,\n                  content: content,\n                  imageUrl: imageUrl,\n                  comments: [],\n                  address: nextProps.address,\n                  hideComments: true\n                });\n\n              case 12:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function componentWillReceiveProps(_x10) {\n        return _componentWillReceiveProps.apply(this, arguments);\n      }\n\n      return componentWillReceiveProps;\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n        var post_address, _Post3, author, content, imageUrl;\n\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context10.sent;\n                post_address = \"0x\" + this.state.address;\n                _Post3 = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), post_address);\n                _context10.next = 7;\n                return _Post3.methods.author().call();\n\n              case 7:\n                author = _context10.sent;\n                _context10.next = 10;\n                return _Post3.methods.content().call();\n\n              case 10:\n                content = _context10.sent;\n                _context10.next = 13;\n                return _Post3.methods.image_hash().call();\n\n              case 13:\n                imageUrl = _context10.sent;\n                this.setState({\n                  author: author,\n                  content: content,\n                  imageUrl: imageUrl,\n                  comments: []\n                });\n\n              case 15:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(\"div\", {\n        className: \"row\",\n        style: {\n          width: \"100%\",\n          height: \"100%\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 4\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 5\n        }\n      }, __jsx(\"title\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 6\n        }\n      }, \"DOSN\"), __jsx(\"link\", {\n        href: \"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\",\n        rel: \"stylesheet\",\n        integrity: \"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 6\n        }\n      }), __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 261,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\",\n        integrity: \"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\",\n        integrity: \"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/jdenticon@2.2.0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 6\n        }\n      })), __jsx(\"div\", {\n        className: \"col-lg-3\",\n        style: {\n          position: \"relative\",\n          textAlign: \"right\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 5\n        }\n      }, __jsx(Navbar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 6\n        }\n      })), __jsx(\"div\", {\n        className: \"container col-lg-9\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 5\n        }\n      }, this.state.is_donate == true && __jsx(DonateCard, {\n        min_tip: this.state.min_tip,\n        isdonatebuttonon: this.isdonatebuttonon,\n        takeback: this.takeback,\n        transact: this.transact,\n        disable_transact_okay: this.state.disable_transact_okay,\n        donating: this.state.donating,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 7\n        }\n      }), this.state.metamask == false && __jsx(MetamaskCard, {\n        takeback: this.takeback,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 7\n        }\n      }), this.state.zoomed !== null && __jsx(ZoomedImage, {\n        zoomed: this.state.zoomed,\n        imageZoom: this.imageZoom,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 7\n        }\n      }), __jsx(FullPost, {\n        address: this.state.address,\n        content: this.state.content,\n        author: this.state.author,\n        imageUrl: this.state.imageUrl,\n        comments: this.state.comments,\n        hideComments: this.state.hideComments,\n        toggleCommentView: this.toggleCommentView,\n        imageZoom: this.imageZoom,\n        donate: this.donate,\n        comment_content: this.state.comment_content,\n        postComment: this.postComment,\n        readContent: this.readContent,\n        captureFile: this.captureFile,\n        uploading: this.state.uploading,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 6\n        }\n      })));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function getInitialProps(props) {\n      return {\n        address: props.query.postid\n      };\n    }\n  }]);\n\n  return Post;\n}(Component);\n\nexport default _c = withRouter(Post);\n\nvar _c;\n\n$RefreshReg$(_c, \"%default%\");","map":{"version":3,"sources":["/home/fa059086/Projects/Decentralized_OSN/pages/posts/[postid].js"],"names":["withRouter","React","Component","ipfs","web3","metamask_provider","PostFactory","ZoomedImage","PostContract","Head","FullPost","DonateCard","MetamaskCard","Navbar","accounts","Post","props","event","preventDefault","setState","metamask","is_donate","stopPropagation","console","log","state","imageUrl","zoomed","comment_content","target","value","hideComments","post_address","address","eth","Contract","JSON","parse","methods","getComments","call","comments_address","new_comments","i","length","Comment","image_hash","author","content","currentComment","push","comments","persist","min_contribution","tip","utils","fromWei","min_tip","file","files","reader","window","FileReader","readAsArrayBuffer","onloadend","buffer","Buffer","result","new_value","disable_transact_okay","getAccounts","donating","post","receiveContribution","send","from","toWei","uploading","add","error","parent_address","createComment","hash","parent_post","file_uploader","document","getElementById","nextProps","width","height","position","textAlign","isdonatebuttonon","takeback","transact","imageZoom","toggleCommentView","donate","postComment","readContent","captureFile","query","postid"],"mappings":"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","sourcesContent":["import { withRouter } from \"next/router\";\nimport React, { Component } from \"react\";\nimport ipfs from \"../../ethereum/ipfs\";\nimport { web3, metamask_provider } from \"../../ethereum/web3\";\nimport PostFactory from \"../../ethereum/factory\";\nimport ZoomedImage from \"../../componenets/ZoomedImage/ZoomedImage\";\nimport PostContract from \"../../ethereum/build/Post.json\";\nimport Head from \"next/head\";\nimport FullPost from \"../../componenets/FullPost/FullPost\";\nimport DonateCard from \"../../componenets/DonateCard/DonateCard\";\nimport MetamaskCard from \"../../componenets/MetamaskCard/MetamaskCard\";\nimport Navbar from \"../../componenets/Navbar/Navbar\";\n\nlet accounts = [];\n\nclass Post extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tauthor: null,\n\t\t\tcontent: null,\n\t\t\timageUrl: null,\n\t\t\taddress: this.props.address,\n\t\t\tcomments: [],\n\t\t\thideComments: true,\n\t\t\tzoomed: null,\n\t\t\tis_donate: false,\n\t\t\tmetamask: true,\n\t\t\tmin_tip: 0,\n\t\t\tvalue: 0,\n\t\t\tcomment_content: \"\",\n\t\t\tdisable_transact_okay: true,\n\t\t\tdonating: false,\n\t\t\tuploading: false,\n\t\t};\n\t}\n\n\tstatic getInitialProps(props) {\n\t\treturn { address: props.query.postid };\n\t}\n\n\tasync componentWillReceiveProps(nextProps) {\n\t\tconst post_address = nextProps.address;\n\t\tconst Post = new web3.eth.Contract(\n\t\t\tJSON.parse(PostContract.interface),\n\t\t\tpost_address\n\t\t);\n\t\tconst author = await Post.methods.author().call();\n\t\tconst content = await Post.methods.content().call();\n\t\tconst imageUrl = await Post.methods.image_hash().call();\n\t\tthis.setState({\n\t\t\tauthor: author,\n\t\t\tcontent: content,\n\t\t\timageUrl: imageUrl,\n\t\t\tcomments: [],\n\t\t\taddress: nextProps.address,\n\t\t\thideComments: true,\n\t\t});\n\t}\n\n\tasync componentDidMount() {\n\t\taccounts = await web3.eth.getAccounts();\n\t\tconst post_address = \"0x\" + this.state.address;\n\t\tconst Post = new web3.eth.Contract(\n\t\t\tJSON.parse(PostContract.interface),\n\t\t\tpost_address\n\t\t);\n\t\tconst author = await Post.methods.author().call();\n\t\tconst content = await Post.methods.content().call();\n\t\tconst imageUrl = await Post.methods.image_hash().call();\n\t\tthis.setState({\n\t\t\tauthor: author,\n\t\t\tcontent: content,\n\t\t\timageUrl: imageUrl,\n\t\t\tcomments: [],\n\t\t});\n\t}\n\n\ttakeback = (event) => {\n\t\tevent.preventDefault();\n\t\tthis.setState({ metamask: true, is_donate: false });\n\t};\n\n\timageZoom = async (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tconsole.log(this.state.imageUrl);\n\t\tif (this.state.zoomed !== null) {\n\t\t\tthis.setState({ zoomed: null });\n\t\t} else {\n\t\t\tthis.setState({\n\t\t\t\tzoomed: `https://ipfs.io/ipfs/${this.state.imageUrl}`,\n\t\t\t});\n\t\t}\n\t};\n\n\treadContent = (event) => {\n\t\tevent.preventDefault();\n\t\tthis.setState({ comment_content: event.target.value });\n\t};\n\n\ttoggleCommentView = async (event) => {\n\t\tif (!this.state.hideComments) {\n\t\t\tthis.setState({ hideComments: true });\n\t\t} else {\n\t\t\tconst post_address = \"0x\" + this.state.address;\n\t\t\tconst Post = new web3.eth.Contract(\n\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\tpost_address\n\t\t\t);\n\t\t\tconst comments_address = await Post.methods.getComments().call();\n\t\t\tconst comments = await (async function (comments_address) {\n\t\t\t\tlet new_comments = [];\n\t\t\t\tfor (let i = 0; i < comments_address.length; i++) {\n\t\t\t\t\tconst Comment = new web3.eth.Contract(\n\t\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\t\tcomments_address[i]\n\t\t\t\t\t);\n\t\t\t\t\tconst currentComment = {\n\t\t\t\t\t\taddress: comments_address[i],\n\t\t\t\t\t\timageUrl: await Comment.methods.image_hash().call(),\n\t\t\t\t\t\tauthor: await Comment.methods.author().call(),\n\t\t\t\t\t\tcontent: await Comment.methods.content().call(),\n\t\t\t\t\t};\n\t\t\t\t\tnew_comments.push(currentComment);\n\t\t\t\t}\n\t\t\t\treturn new_comments;\n\t\t\t})(comments_address);\n\t\t\tthis.setState({ comments: comments, hideComments: false });\n\t\t}\n\t};\n\n\tdonate = async (event) => {\n\t\tevent.persist();\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tlet tip = await PostFactory.methods.min_contribution().call();\n\t\ttip = web3.utils.fromWei(tip, \"ether\");\n\t\tthis.setState({\n\t\t\tis_donate: true,\n\t\t\tmin_tip: tip,\n\t\t});\n\t};\n\n\tcaptureFile = (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tconst file = event.target.files[0];\n\t\tconst reader = new window.FileReader();\n\t\treader.readAsArrayBuffer(file);\n\t\treader.onloadend = () => {\n\t\t\tthis.setState({ buffer: Buffer(reader.result) });\n\t\t};\n\t};\n\n\tisdonatebuttonon = (event) => {\n\t\tevent.preventDefault();\n\t\tlet new_value = true;\n\t\tif (event.target.value >= this.state.min_tip) {\n\t\t\tnew_value = false;\n\t\t}\n\t\tthis.setState({\n\t\t\tvalue: event.target.value,\n\t\t\tdisable_transact_okay: new_value,\n\t\t});\n\t};\n\n\ttransact = async (event) => {\n\t\tevent.persist();\n\t\tevent.preventDefault();\n\t\taccounts = await web3.eth.getAccounts();\n\t\tif (metamask_provider == false || accounts.length == 0) {\n\t\t\tthis.setState({ metamask: false, is_donate: false });\n\t\t} else {\n\t\t\tthis.setState({ metamask: true, donating: true });\n\t\t\tconst address = this.state.address;\n\t\t\tconst post = new web3.eth.Contract(\n\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\taddress\n\t\t\t);\n\t\t\tawait post.methods.receiveContribution().send({\n\t\t\t\tfrom: accounts[0],\n\t\t\t\tvalue: web3.utils.toWei(this.state.value, \"ether\"),\n\t\t\t});\n\t\t\tthis.setState({\n\t\t\t\tmetamask: true,\n\t\t\t\tvalue: 0,\n\t\t\t\tis_donate: false,\n\t\t\t\tdonating: false,\n\t\t\t});\n\t\t}\n\t};\n\n\tpostComment = async (event) => {\n\t\tevent.persist();\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\taccounts = await web3.eth.getAccounts();\n\t\tif (metamask_provider == false || accounts.length == 0) {\n\t\t\tthis.setState({ metamask: false });\n\t\t} else {\n\t\t\tthis.setState({ metamask: true, uploading: true });\n\t\t\tipfs.files.add(this.state.buffer, async (error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst parent_address = \"0x\" + this.state.address;\n\t\t\t\tawait PostFactory.methods\n\t\t\t\t\t.createComment(\n\t\t\t\t\t\tparent_address,\n\t\t\t\t\t\tresult[0].hash,\n\t\t\t\t\t\tthis.state.comment_content\n\t\t\t\t\t)\n\t\t\t\t\t.send({ from: accounts[0] });\n\t\t\t\tconst parent_post = new web3.eth.Contract(\n\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\tparent_address\n\t\t\t\t);\n\t\t\t\tconst comments_address = await parent_post.methods\n\t\t\t\t\t.getComments()\n\t\t\t\t\t.call();\n\t\t\t\tconst comments = await (async function (comments_address) {\n\t\t\t\t\tlet new_comments = [];\n\t\t\t\t\tfor (let i = 0; i < comments_address.length; i++) {\n\t\t\t\t\t\tconst Comment = new web3.eth.Contract(\n\t\t\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\t\t\tcomments_address[i]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst currentComment = {\n\t\t\t\t\t\t\timageUrl: await Comment.methods.image_hash().call(),\n\t\t\t\t\t\t\tauthor: await Comment.methods.author().call(),\n\t\t\t\t\t\t\tcontent: await Comment.methods.content().call(),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tnew_comments.push(currentComment);\n\t\t\t\t\t}\n\t\t\t\t\treturn new_comments;\n\t\t\t\t})(comments_address);\n\t\t\t\tthis.setState({\n\t\t\t\t\tcomments: comments,\n\t\t\t\t\tcomment_content: \"\",\n\t\t\t\t\tuploading: false,\n\t\t\t\t});\n\t\t\t\tconst file_uploader = document.getElementById(\"file_upload_2\");\n\t\t\t\tfile_uploader.value = \"\";\n\t\t\t});\n\t\t}\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row\" style={{ width: \"100%\", height: \"100%\" }}>\n\t\t\t\t<Head>\n\t\t\t\t\t<title>DOSN</title>\n\t\t\t\t\t<link\n\t\t\t\t\t\thref=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\"\n\t\t\t\t\t\trel=\"stylesheet\"\n\t\t\t\t\t\tintegrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></link>\n\t\t\t\t\t<link\n\t\t\t\t\t\trel=\"stylesheet\"\n\t\t\t\t\t\thref=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"\n\t\t\t\t\t></link>\n\t\t\t\t\t<script\n\t\t\t\t\t\tsrc=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\"\n\t\t\t\t\t\tintegrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></script>\n\t\t\t\t\t<script\n\t\t\t\t\t\tsrc=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\"\n\t\t\t\t\t\tintegrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></script>\n\t\t\t\t\t<script src=\"https://cdn.jsdelivr.net/npm/jdenticon@2.2.0\"></script>\n\t\t\t\t</Head>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"col-lg-3\"\n\t\t\t\t\tstyle={{ position: \"relative\", textAlign: \"right\" }}\n\t\t\t\t>\n\t\t\t\t\t<Navbar />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"container col-lg-9\">\n\t\t\t\t\t{this.state.is_donate == true && (\n\t\t\t\t\t\t<DonateCard\n\t\t\t\t\t\t\tmin_tip={this.state.min_tip}\n\t\t\t\t\t\t\tisdonatebuttonon={this.isdonatebuttonon}\n\t\t\t\t\t\t\ttakeback={this.takeback}\n\t\t\t\t\t\t\ttransact={this.transact}\n\t\t\t\t\t\t\tdisable_transact_okay={\n\t\t\t\t\t\t\t\tthis.state.disable_transact_okay\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdonating={this.state.donating}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{this.state.metamask == false && (\n\t\t\t\t\t\t<MetamaskCard takeback={this.takeback} />\n\t\t\t\t\t)}\n\t\t\t\t\t{this.state.zoomed !== null && (\n\t\t\t\t\t\t<ZoomedImage\n\t\t\t\t\t\t\tzoomed={this.state.zoomed}\n\t\t\t\t\t\t\timageZoom={this.imageZoom}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<FullPost\n\t\t\t\t\t\taddress={this.state.address}\n\t\t\t\t\t\tcontent={this.state.content}\n\t\t\t\t\t\tauthor={this.state.author}\n\t\t\t\t\t\timageUrl={this.state.imageUrl}\n\t\t\t\t\t\tcomments={this.state.comments}\n\t\t\t\t\t\thideComments={this.state.hideComments}\n\t\t\t\t\t\ttoggleCommentView={this.toggleCommentView}\n\t\t\t\t\t\timageZoom={this.imageZoom}\n\t\t\t\t\t\tdonate={this.donate}\n\t\t\t\t\t\tcomment_content={this.state.comment_content}\n\t\t\t\t\t\tpostComment={this.postComment}\n\t\t\t\t\t\treadContent={this.readContent}\n\t\t\t\t\t\tcaptureFile={this.captureFile}\n\t\t\t\t\t\tuploading={this.state.uploading}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default withRouter(Post);\n"]},"metadata":{},"sourceType":"module"}