{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/fa059086/Projects/Decentralized_OSN/pages/index.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport PostFactory from \"../ethereum/factory\";\nimport PostContract from \"../ethereum/build/Post.json\";\nimport ipfs from \"../ethereum/ipfs\";\nimport { web3, metamask_provider } from \"../ethereum/web3\";\nimport Head from \"next/head\";\nimport TweetForm from \"../componenets/TweetForm/TweetForm\";\nimport TweetCard from \"../componenets/TweetCard/TweetCard\";\nimport LoadingCard from \"../componenets/LoadingCard/LoadingCard\";\nimport ZoomedImage from \"../componenets/ZoomedImage/ZoomedImage\";\nimport MetamaskCard from \"../componenets/MetamaskCard/MetamaskCard\";\nimport DonateCard from \"../componenets/DonateCard/DonateCard\";\nimport Navbar from \"../componenets/Navbar/Navbar\";\nvar accounts = [];\n\nvar PostIndex = /*#__PURE__*/function (_Component) {\n  _inherits(PostIndex, _Component);\n\n  var _super = _createSuper(PostIndex);\n\n  function PostIndex(props) {\n    var _this;\n\n    _classCallCheck(this, PostIndex);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"isLoaded\", function () {\n      _this.setState(function (prevState, props) {\n        return {\n          loading: prevState.loading + 1\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"isdonatebuttonon\", function (event) {\n      event.preventDefault();\n      var new_value = true;\n\n      if (event.target.value >= _this.state.min_tip) {\n        new_value = false;\n      }\n\n      _this.setState({\n        value: event.target.value,\n        disable_transact_okay: new_value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"captureFile\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n      var file = event.target.files[0];\n      var reader = new window.FileReader();\n      reader.readAsArrayBuffer(file);\n\n      reader.onloadend = function () {\n        _this.setState({\n          buffer: Buffer(reader.result)\n        });\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"takeback\", function (event) {\n      event.preventDefault();\n\n      _this.setState({\n        metamask: true,\n        is_donate: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"donate\", /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(event) {\n        var tip;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                event.persist();\n                event.stopPropagation();\n                event.preventDefault();\n                _context.next = 5;\n                return PostFactory.methods.min_contribution().call();\n\n              case 5:\n                tip = _context.sent;\n                tip = web3.utils.fromWei(tip, \"ether\");\n\n                _this.setState({\n                  is_donate: true,\n                  min_tip: tip,\n                  tip_post_key: event.target.getAttribute(\"data-index\")\n                });\n\n              case 8:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"transact\", /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(event) {\n        var index, address, post;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                event.persist();\n                event.preventDefault();\n                _context2.next = 4;\n                return web3.eth.getAccounts();\n\n              case 4:\n                accounts = _context2.sent;\n\n                if (!(metamask_provider == false || accounts.length == 0)) {\n                  _context2.next = 9;\n                  break;\n                }\n\n                _this.setState({\n                  metamask: false,\n                  is_donate: false\n                });\n\n                _context2.next = 18;\n                break;\n\n              case 9:\n                _this.setState({\n                  metamask: true,\n                  donating: true\n                });\n\n                index = _this.state.tip_post_key;\n                _context2.next = 13;\n                return PostFactory.methods.deployedPosts(index).call();\n\n              case 13:\n                address = _context2.sent;\n                post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), address);\n                _context2.next = 17;\n                return post.methods.receiveContribution().send({\n                  from: accounts[0],\n                  value: web3.utils.toWei(_this.state.value, \"ether\")\n                });\n\n              case 17:\n                _this.setState({\n                  metamask: true,\n                  value: 0,\n                  is_donate: false,\n                  donating: false\n                });\n\n              case 18:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"commentHide\", /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(event) {\n        var index, comments_div, posts, Post, comments_address, comments, new_posts;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                event.preventDefault();\n                event.stopPropagation();\n                index = event.target.getAttribute(\"data-index\");\n                comments_div = document.getElementById(\"comments\" + index);\n\n                if (comments_div.style.display === \"none\") {\n                  comments_div.style.display = \"block\";\n                } else {\n                  comments_div.style.display = \"none\";\n                }\n\n                _context4.next = 7;\n                return PostFactory.methods.getPosts().call();\n\n              case 7:\n                posts = _context4.sent;\n                Post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), posts[index]);\n                _context4.next = 11;\n                return Post.methods.getComments().call();\n\n              case 11:\n                comments_address = _context4.sent;\n\n                if (!(comments_address.length != 0 && typeof comments_address[0] == \"string\")) {\n                  _context4.next = 19;\n                  break;\n                }\n\n                _context4.next = 15;\n                return function () {\n                  var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(comments_address) {\n                    var new_comments, i, Comment, currentComment;\n                    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                      while (1) {\n                        switch (_context3.prev = _context3.next) {\n                          case 0:\n                            new_comments = [];\n                            i = 0;\n\n                          case 2:\n                            if (!(i < comments_address.length)) {\n                              _context3.next = 19;\n                              break;\n                            }\n\n                            Comment = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), comments_address[i]);\n                            _context3.t0 = comments_address[i];\n                            _context3.next = 7;\n                            return Comment.methods.image_hash().call();\n\n                          case 7:\n                            _context3.t1 = _context3.sent;\n                            _context3.next = 10;\n                            return Comment.methods.author().call();\n\n                          case 10:\n                            _context3.t2 = _context3.sent;\n                            _context3.next = 13;\n                            return Comment.methods.content().call();\n\n                          case 13:\n                            _context3.t3 = _context3.sent;\n                            currentComment = {\n                              address: _context3.t0,\n                              imageUrl: _context3.t1,\n                              author: _context3.t2,\n                              content: _context3.t3\n                            };\n                            new_comments.push(currentComment);\n\n                          case 16:\n                            i++;\n                            _context3.next = 2;\n                            break;\n\n                          case 19:\n                            return _context3.abrupt(\"return\", new_comments);\n\n                          case 20:\n                          case \"end\":\n                            return _context3.stop();\n                        }\n                      }\n                    }, _callee3);\n                  }));\n\n                  return function (_x4) {\n                    return _ref4.apply(this, arguments);\n                  };\n                }()(comments_address);\n\n              case 15:\n                comments = _context4.sent;\n                new_posts = _this.state.posts;\n                new_posts[index].comments = comments;\n\n                _this.setState({\n                  posts: new_posts\n                });\n\n              case 19:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"postComment\", /*#__PURE__*/function () {\n      var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7(event) {\n        var parent_index;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                event.persist();\n                event.preventDefault();\n                event.stopPropagation();\n                _context7.next = 5;\n                return web3.eth.getAccounts();\n\n              case 5:\n                accounts = _context7.sent;\n                parent_index = event.target.getAttribute(\"data-index\");\n\n                if (metamask_provider == false || accounts.length == 0) {\n                  _this.setState({\n                    metamask: false\n                  });\n                } else {\n                  _this.setState({\n                    metamask: true,\n                    uploading: true\n                  });\n\n                  ipfs.files.add(_this.state.buffer, /*#__PURE__*/function () {\n                    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(error, result) {\n                      var parent_address, parent_post, comments_address, new_posts, comments, file_uploader;\n                      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                        while (1) {\n                          switch (_context6.prev = _context6.next) {\n                            case 0:\n                              if (!error) {\n                                _context6.next = 3;\n                                break;\n                              }\n\n                              console.error(error);\n                              return _context6.abrupt(\"return\");\n\n                            case 3:\n                              _context6.next = 5;\n                              return PostFactory.methods.deployedPosts(parent_index).call();\n\n                            case 5:\n                              parent_address = _context6.sent;\n                              _context6.next = 8;\n                              return PostFactory.methods.createComment(parent_address, result[0].hash, _this.state.content).send({\n                                from: accounts[0]\n                              });\n\n                            case 8:\n                              parent_post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), parent_address);\n                              _context6.next = 11;\n                              return parent_post.methods.getComments().call();\n\n                            case 11:\n                              comments_address = _context6.sent;\n                              new_posts = _this.state.posts;\n                              _context6.next = 15;\n                              return function () {\n                                var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(comments_address) {\n                                  var new_comments, i, Comment, currentComment;\n                                  return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                                    while (1) {\n                                      switch (_context5.prev = _context5.next) {\n                                        case 0:\n                                          new_comments = [];\n                                          i = 0;\n\n                                        case 2:\n                                          if (!(i < comments_address.length)) {\n                                            _context5.next = 18;\n                                            break;\n                                          }\n\n                                          Comment = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), comments_address[i]);\n                                          _context5.next = 6;\n                                          return Comment.methods.image_hash().call();\n\n                                        case 6:\n                                          _context5.t0 = _context5.sent;\n                                          _context5.next = 9;\n                                          return Comment.methods.author().call();\n\n                                        case 9:\n                                          _context5.t1 = _context5.sent;\n                                          _context5.next = 12;\n                                          return Comment.methods.content().call();\n\n                                        case 12:\n                                          _context5.t2 = _context5.sent;\n                                          currentComment = {\n                                            imageUrl: _context5.t0,\n                                            author: _context5.t1,\n                                            content: _context5.t2\n                                          };\n                                          new_comments.push(currentComment);\n\n                                        case 15:\n                                          i++;\n                                          _context5.next = 2;\n                                          break;\n\n                                        case 18:\n                                          return _context5.abrupt(\"return\", new_comments);\n\n                                        case 19:\n                                        case \"end\":\n                                          return _context5.stop();\n                                      }\n                                    }\n                                  }, _callee5);\n                                }));\n\n                                return function (_x8) {\n                                  return _ref7.apply(this, arguments);\n                                };\n                              }()(comments_address);\n\n                            case 15:\n                              comments = _context6.sent;\n                              new_posts[parent_index].comments = comments;\n\n                              _this.setState({\n                                posts: new_posts,\n                                content: \"\",\n                                uploading: false\n                              });\n\n                              file_uploader = document.getElementById(\"file_upload_2\");\n                              file_uploader.value = \"\";\n\n                            case 20:\n                            case \"end\":\n                              return _context6.stop();\n                          }\n                        }\n                      }, _callee6);\n                    }));\n\n                    return function (_x6, _x7) {\n                      return _ref6.apply(this, arguments);\n                    };\n                  }());\n                }\n\n              case 8:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmit\", /*#__PURE__*/function () {\n      var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(event) {\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                event.preventDefault();\n                _context10.next = 3;\n                return web3.eth.getAccounts();\n\n              case 3:\n                accounts = _context10.sent;\n\n                if (metamask_provider == false || accounts.length == 0) {\n                  _this.setState({\n                    metamask: false\n                  });\n                } else {\n                  _this.setState({\n                    metamask: true,\n                    uploading: true\n                  });\n\n                  ipfs.files.add(_this.state.buffer, /*#__PURE__*/function () {\n                    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(error, result) {\n                      var posts, new_posts, file_uploader;\n                      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                        while (1) {\n                          switch (_context9.prev = _context9.next) {\n                            case 0:\n                              if (!error) {\n                                _context9.next = 3;\n                                break;\n                              }\n\n                              console.error(error);\n                              return _context9.abrupt(\"return\");\n\n                            case 3:\n                              _context9.next = 5;\n                              return PostFactory.methods.createPost(result[0].hash, _this.state.content).send({\n                                from: accounts[0]\n                              });\n\n                            case 5:\n                              _context9.next = 7;\n                              return PostFactory.methods.getPosts().call();\n\n                            case 7:\n                              posts = _context9.sent;\n                              _context9.next = 10;\n                              return function () {\n                                var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(posts) {\n                                  var new_posts, i, Post, currentPost;\n                                  return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                                    while (1) {\n                                      switch (_context8.prev = _context8.next) {\n                                        case 0:\n                                          new_posts = [];\n                                          i = 0;\n\n                                        case 2:\n                                          if (!(i < posts.length)) {\n                                            _context8.next = 21;\n                                            break;\n                                          }\n\n                                          Post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), posts[i]);\n                                          _context8.next = 6;\n                                          return Post.methods.image_hash().call();\n\n                                        case 6:\n                                          _context8.t0 = _context8.sent;\n                                          _context8.next = 9;\n                                          return Post.methods.author().call();\n\n                                        case 9:\n                                          _context8.t1 = _context8.sent;\n                                          _context8.next = 12;\n                                          return Post.methods.content().call();\n\n                                        case 12:\n                                          _context8.t2 = _context8.sent;\n                                          _context8.next = 15;\n                                          return Post.methods.getComments().call();\n\n                                        case 15:\n                                          _context8.t3 = _context8.sent;\n                                          currentPost = {\n                                            imageUrl: _context8.t0,\n                                            author: _context8.t1,\n                                            content: _context8.t2,\n                                            comments: _context8.t3\n                                          };\n                                          new_posts.push(currentPost);\n\n                                        case 18:\n                                          i++;\n                                          _context8.next = 2;\n                                          break;\n\n                                        case 21:\n                                          return _context8.abrupt(\"return\", new_posts);\n\n                                        case 22:\n                                        case \"end\":\n                                          return _context8.stop();\n                                      }\n                                    }\n                                  }, _callee8);\n                                }));\n\n                                return function (_x12) {\n                                  return _ref10.apply(this, arguments);\n                                };\n                              }()(posts);\n\n                            case 10:\n                              new_posts = _context9.sent;\n\n                              _this.setState({\n                                posts: new_posts,\n                                content: \"\",\n                                uploading: false\n                              });\n\n                              file_uploader = document.getElementById(\"file_upload\");\n                              file_uploader.value = \"\";\n\n                            case 14:\n                            case \"end\":\n                              return _context9.stop();\n                          }\n                        }\n                      }, _callee9);\n                    }));\n\n                    return function (_x10, _x11) {\n                      return _ref9.apply(this, arguments);\n                    };\n                  }());\n                }\n\n              case 5:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10);\n      }));\n\n      return function (_x9) {\n        return _ref8.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"imageZoom\", /*#__PURE__*/function () {\n      var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(event) {\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                event.preventDefault();\n                event.stopPropagation();\n\n                if (_this.state.zoomed !== null) {\n                  _this.setState({\n                    zoomed: null\n                  });\n                } else {\n                  _this.setState({\n                    zoomed: event.target.getAttribute(\"src\")\n                  });\n                }\n\n              case 3:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11);\n      }));\n\n      return function (_x13) {\n        return _ref11.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"readContent\", function (event) {\n      event.preventDefault();\n      event.stopPropagation();\n\n      _this.setState({\n        content: event.target.value\n      });\n    });\n\n    _this.state = {\n      posts: _this.props.posts,\n      buffer: null,\n      content: \"\",\n      zoomed: null,\n      loading: 0,\n      uploading: false,\n      matamask: true,\n      is_donate: false,\n      min_tip: 0,\n      value: 0,\n      tip_post_key: 0,\n      donating: false,\n      disable_transact_okay: true\n    };\n    return _this;\n  }\n\n  _createClass(PostIndex, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _context12.next = 2;\n                return web3.eth.getAccounts();\n\n              case 2:\n                accounts = _context12.sent;\n\n              case 3:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return __jsx(\"div\", {\n        className: \"row\",\n        style: {},\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 4\n        }\n      }, __jsx(Head, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 5\n        }\n      }, __jsx(\"title\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 6\n        }\n      }, \"DOSN\"), __jsx(\"link\", {\n        href: \"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\",\n        rel: \"stylesheet\",\n        integrity: \"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 6\n        }\n      }), __jsx(\"link\", {\n        rel: \"stylesheet\",\n        href: \"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\",\n        integrity: \"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\",\n        integrity: \"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\",\n        crossorigin: \"anonymous\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 6\n        }\n      }), __jsx(\"script\", {\n        src: \"https://cdn.jsdelivr.net/npm/jdenticon@2.2.0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 6\n        }\n      })), __jsx(\"div\", {\n        className: \"col-lg-3\",\n        style: {\n          position: \"relative\",\n          textAlign: \"right\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 5\n        }\n      }, __jsx(Navbar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 6\n        }\n      })), __jsx(\"div\", {\n        className: \"container col-lg-9\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 5\n        }\n      }, this.state.is_donate == true && __jsx(DonateCard, {\n        min_tip: this.state.min_tip,\n        isdonatebuttonon: this.isdonatebuttonon,\n        takeback: this.takeback,\n        transact: this.transact,\n        disable_transact_okay: this.state.disable_transact_okay,\n        donating: this.state.donating,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 7\n        }\n      }), this.state.metamask == false && __jsx(MetamaskCard, {\n        takeback: this.takeback,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 354,\n          columnNumber: 7\n        }\n      }), this.state.loading != this.state.posts.length && __jsx(LoadingCard, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 357,\n          columnNumber: 7\n        }\n      }), this.state.zoomed !== null && __jsx(ZoomedImage, {\n        zoomed: this.state.zoomed,\n        imageZoom: this.imageZoom,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 360,\n          columnNumber: 7\n        }\n      }), __jsx(TweetForm, {\n        content: this.state.content,\n        uploading: this.state.uploading,\n        submit: this.onSubmit,\n        readContent: this.readContent,\n        captureFile: this.captureFile,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 365,\n          columnNumber: 6\n        }\n      }), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 6\n        }\n      }, this.state.posts.slice(0).reverse().map(function (post, index) {\n        return __jsx(TweetCard, {\n          postLength: _this2.state.posts.length,\n          post: post,\n          index: index,\n          imageZoom: _this2.imageZoom,\n          donate: _this2.donate,\n          commentHide: _this2.commentHide,\n          postComment: _this2.postComment,\n          readContent: _this2.readContent,\n          content: _this2.state.content,\n          captureFile: _this2.captureFile,\n          uploading: _this2.state.uploading,\n          key: index,\n          imageLoaded: _this2.imageLoaded,\n          isLoaded: _this2.isLoaded,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 377,\n            columnNumber: 9\n          }\n        });\n      }))));\n    }\n  }], [{\n    key: \"getInitialProps\",\n    value: function () {\n      var _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n        var posts, new_posts;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return PostFactory.methods.getPosts().call();\n\n              case 2:\n                posts = _context14.sent;\n                _context14.next = 5;\n                return function () {\n                  var _ref12 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(posts) {\n                    var new_posts, i, Post, currentPost;\n                    return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n                      while (1) {\n                        switch (_context13.prev = _context13.next) {\n                          case 0:\n                            new_posts = [];\n                            i = 0;\n\n                          case 2:\n                            if (!(i < posts.length)) {\n                              _context13.next = 20;\n                              break;\n                            }\n\n                            Post = new web3.eth.Contract(JSON.parse(PostContract[\"interface\"]), posts[i]);\n                            _context13.t0 = posts[i];\n                            _context13.next = 7;\n                            return Post.methods.image_hash().call();\n\n                          case 7:\n                            _context13.t1 = _context13.sent;\n                            _context13.next = 10;\n                            return Post.methods.author().call();\n\n                          case 10:\n                            _context13.t2 = _context13.sent;\n                            _context13.next = 13;\n                            return Post.methods.content().call();\n\n                          case 13:\n                            _context13.t3 = _context13.sent;\n                            _context13.t4 = [];\n                            currentPost = {\n                              address: _context13.t0,\n                              imageUrl: _context13.t1,\n                              author: _context13.t2,\n                              content: _context13.t3,\n                              comments: _context13.t4\n                            };\n                            new_posts.push(currentPost);\n\n                          case 17:\n                            i++;\n                            _context13.next = 2;\n                            break;\n\n                          case 20:\n                            return _context13.abrupt(\"return\", new_posts);\n\n                          case 21:\n                          case \"end\":\n                            return _context13.stop();\n                        }\n                      }\n                    }, _callee13);\n                  }));\n\n                  return function (_x14) {\n                    return _ref12.apply(this, arguments);\n                  };\n                }()(posts);\n\n              case 5:\n                new_posts = _context14.sent;\n                return _context14.abrupt(\"return\", {\n                  posts: new_posts\n                });\n\n              case 7:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14);\n      }));\n\n      function getInitialProps() {\n        return _getInitialProps.apply(this, arguments);\n      }\n\n      return getInitialProps;\n    }()\n  }]);\n\n  return PostIndex;\n}(Component);\n\nexport default PostIndex;","map":{"version":3,"sources":["/home/fa059086/Projects/Decentralized_OSN/pages/index.js"],"names":["React","Component","PostFactory","PostContract","ipfs","web3","metamask_provider","Head","TweetForm","TweetCard","LoadingCard","ZoomedImage","MetamaskCard","DonateCard","Navbar","accounts","PostIndex","props","setState","prevState","loading","event","preventDefault","new_value","target","value","state","min_tip","disable_transact_okay","stopPropagation","file","files","reader","window","FileReader","readAsArrayBuffer","onloadend","buffer","Buffer","result","metamask","is_donate","persist","methods","min_contribution","call","tip","utils","fromWei","tip_post_key","getAttribute","eth","getAccounts","length","donating","index","deployedPosts","address","post","Contract","JSON","parse","receiveContribution","send","from","toWei","comments_div","document","getElementById","style","display","getPosts","posts","Post","getComments","comments_address","new_comments","i","Comment","image_hash","author","content","currentComment","imageUrl","push","comments","new_posts","parent_index","uploading","add","error","console","parent_address","createComment","hash","parent_post","file_uploader","createPost","currentPost","zoomed","matamask","position","textAlign","isdonatebuttonon","takeback","transact","imageZoom","onSubmit","readContent","captureFile","slice","reverse","map","donate","commentHide","postComment","imageLoaded","isLoaded"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport PostFactory from \"../ethereum/factory\";\nimport PostContract from \"../ethereum/build/Post.json\";\nimport ipfs from \"../ethereum/ipfs\";\nimport { web3, metamask_provider } from \"../ethereum/web3\";\nimport Head from \"next/head\";\nimport TweetForm from \"../componenets/TweetForm/TweetForm\";\nimport TweetCard from \"../componenets/TweetCard/TweetCard\";\nimport LoadingCard from \"../componenets/LoadingCard/LoadingCard\";\nimport ZoomedImage from \"../componenets/ZoomedImage/ZoomedImage\";\nimport MetamaskCard from \"../componenets/MetamaskCard/MetamaskCard\";\nimport DonateCard from \"../componenets/DonateCard/DonateCard\";\nimport Navbar from \"../componenets/Navbar/Navbar\";\n\nlet accounts = [];\n\nclass PostIndex extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tposts: this.props.posts,\n\t\t\tbuffer: null,\n\t\t\tcontent: \"\",\n\t\t\tzoomed: null,\n\t\t\tloading: 0,\n\t\t\tuploading: false,\n\t\t\tmatamask: true,\n\t\t\tis_donate: false,\n\t\t\tmin_tip: 0,\n\t\t\tvalue: 0,\n\t\t\ttip_post_key: 0,\n\t\t\tdonating: false,\n\t\t\tdisable_transact_okay: true,\n\t\t};\n\t}\n\n\tasync componentDidMount() {\n\t\taccounts = await web3.eth.getAccounts();\n\t}\n\n\tisLoaded = () => {\n\t\tthis.setState((prevState, props) => ({\n\t\t\tloading: prevState.loading + 1,\n\t\t}));\n\t};\n\n\tstatic async getInitialProps() {\n\t\tconst posts = await PostFactory.methods.getPosts().call();\n\t\tlet new_posts = await (async function (posts) {\n\t\t\tlet new_posts = [];\n\t\t\tfor (let i = 0; i < posts.length; i++) {\n\t\t\t\tconst Post = new web3.eth.Contract(\n\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\tposts[i]\n\t\t\t\t);\n\t\t\t\tconst currentPost = {\n\t\t\t\t\taddress: posts[i],\n\t\t\t\t\timageUrl: await Post.methods.image_hash().call(),\n\t\t\t\t\tauthor: await Post.methods.author().call(),\n\t\t\t\t\tcontent: await Post.methods.content().call(),\n\t\t\t\t\tcomments: [],\n\t\t\t\t};\n\t\t\t\tnew_posts.push(currentPost);\n\t\t\t}\n\t\t\treturn new_posts;\n\t\t})(posts);\n\t\treturn { posts: new_posts };\n\t}\n\n\tisdonatebuttonon = (event) => {\n\t\tevent.preventDefault();\n\t\tlet new_value = true;\n\t\tif (event.target.value >= this.state.min_tip) {\n\t\t\tnew_value = false;\n\t\t}\n\t\tthis.setState({\n\t\t\tvalue: event.target.value,\n\t\t\tdisable_transact_okay: new_value,\n\t\t});\n\t};\n\n\tcaptureFile = (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tconst file = event.target.files[0];\n\t\tconst reader = new window.FileReader();\n\t\treader.readAsArrayBuffer(file);\n\t\treader.onloadend = () => {\n\t\t\tthis.setState({ buffer: Buffer(reader.result) });\n\t\t};\n\t};\n\n\ttakeback = (event) => {\n\t\tevent.preventDefault();\n\t\tthis.setState({ metamask: true, is_donate: false });\n\t};\n\n\tdonate = async (event) => {\n\t\tevent.persist();\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t\tlet tip = await PostFactory.methods.min_contribution().call();\n\t\ttip = web3.utils.fromWei(tip, \"ether\");\n\t\tthis.setState({\n\t\t\tis_donate: true,\n\t\t\tmin_tip: tip,\n\t\t\ttip_post_key: event.target.getAttribute(\"data-index\"),\n\t\t});\n\t};\n\n\ttransact = async (event) => {\n\t\tevent.persist();\n\t\tevent.preventDefault();\n\t\taccounts = await web3.eth.getAccounts();\n\t\tif (metamask_provider == false || accounts.length == 0) {\n\t\t\tthis.setState({ metamask: false, is_donate: false });\n\t\t} else {\n\t\t\tthis.setState({ metamask: true, donating: true });\n\t\t\tconst index = this.state.tip_post_key;\n\t\t\tconst address = await PostFactory.methods\n\t\t\t\t.deployedPosts(index)\n\t\t\t\t.call();\n\t\t\tconst post = new web3.eth.Contract(\n\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\taddress\n\t\t\t);\n\t\t\tawait post.methods.receiveContribution().send({\n\t\t\t\tfrom: accounts[0],\n\t\t\t\tvalue: web3.utils.toWei(this.state.value, \"ether\"),\n\t\t\t});\n\t\t\tthis.setState({\n\t\t\t\tmetamask: true,\n\t\t\t\tvalue: 0,\n\t\t\t\tis_donate: false,\n\t\t\t\tdonating: false,\n\t\t\t});\n\t\t}\n\t};\n\n\tcommentHide = async (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tconst index = event.target.getAttribute(\"data-index\");\n\t\tvar comments_div = document.getElementById(\"comments\" + index);\n\t\tif (comments_div.style.display === \"none\") {\n\t\t\tcomments_div.style.display = \"block\";\n\t\t} else {\n\t\t\tcomments_div.style.display = \"none\";\n\t\t}\n\t\tconst posts = await PostFactory.methods.getPosts().call();\n\t\tconst Post = new web3.eth.Contract(\n\t\t\tJSON.parse(PostContract.interface),\n\t\t\tposts[index]\n\t\t);\n\t\tconst comments_address = await Post.methods.getComments().call();\n\t\tif (\n\t\t\tcomments_address.length != 0 &&\n\t\t\ttypeof comments_address[0] == \"string\"\n\t\t) {\n\t\t\tconst comments = await (async function (comments_address) {\n\t\t\t\tlet new_comments = [];\n\t\t\t\tfor (let i = 0; i < comments_address.length; i++) {\n\t\t\t\t\tconst Comment = new web3.eth.Contract(\n\t\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\t\tcomments_address[i]\n\t\t\t\t\t);\n\t\t\t\t\tconst currentComment = {\n\t\t\t\t\t\taddress: comments_address[i],\n\t\t\t\t\t\timageUrl: await Comment.methods.image_hash().call(),\n\t\t\t\t\t\tauthor: await Comment.methods.author().call(),\n\t\t\t\t\t\tcontent: await Comment.methods.content().call(),\n\t\t\t\t\t};\n\t\t\t\t\tnew_comments.push(currentComment);\n\t\t\t\t}\n\t\t\t\treturn new_comments;\n\t\t\t})(comments_address);\n\t\t\tlet new_posts = this.state.posts;\n\t\t\tnew_posts[index].comments = comments;\n\t\t\tthis.setState({ posts: new_posts });\n\t\t}\n\t};\n\n\tpostComment = async (event) => {\n\t\tevent.persist();\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\taccounts = await web3.eth.getAccounts();\n\t\tconst parent_index = event.target.getAttribute(\"data-index\");\n\t\tif (metamask_provider == false || accounts.length == 0) {\n\t\t\tthis.setState({ metamask: false });\n\t\t} else {\n\t\t\tthis.setState({ metamask: true, uploading: true });\n\t\t\tipfs.files.add(this.state.buffer, async (error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst parent_address = await PostFactory.methods\n\t\t\t\t\t.deployedPosts(parent_index)\n\t\t\t\t\t.call();\n\t\t\t\tawait PostFactory.methods\n\t\t\t\t\t.createComment(\n\t\t\t\t\t\tparent_address,\n\t\t\t\t\t\tresult[0].hash,\n\t\t\t\t\t\tthis.state.content\n\t\t\t\t\t)\n\t\t\t\t\t.send({ from: accounts[0] });\n\t\t\t\tconst parent_post = new web3.eth.Contract(\n\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\tparent_address\n\t\t\t\t);\n\t\t\t\tconst comments_address = await parent_post.methods\n\t\t\t\t\t.getComments()\n\t\t\t\t\t.call();\n\t\t\t\tlet new_posts = this.state.posts;\n\t\t\t\tconst comments = await (async function (comments_address) {\n\t\t\t\t\tlet new_comments = [];\n\t\t\t\t\tfor (let i = 0; i < comments_address.length; i++) {\n\t\t\t\t\t\tconst Comment = new web3.eth.Contract(\n\t\t\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\t\t\tcomments_address[i]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst currentComment = {\n\t\t\t\t\t\t\timageUrl: await Comment.methods.image_hash().call(),\n\t\t\t\t\t\t\tauthor: await Comment.methods.author().call(),\n\t\t\t\t\t\t\tcontent: await Comment.methods.content().call(),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tnew_comments.push(currentComment);\n\t\t\t\t\t}\n\t\t\t\t\treturn new_comments;\n\t\t\t\t})(comments_address);\n\t\t\t\tnew_posts[parent_index].comments = comments;\n\t\t\t\tthis.setState({\n\t\t\t\t\tposts: new_posts,\n\t\t\t\t\tcontent: \"\",\n\t\t\t\t\tuploading: false,\n\t\t\t\t});\n\t\t\t\tconst file_uploader = document.getElementById(\"file_upload_2\");\n\t\t\t\tfile_uploader.value = \"\";\n\t\t\t});\n\t\t}\n\t};\n\n\tonSubmit = async (event) => {\n\t\tevent.preventDefault();\n\t\taccounts = await web3.eth.getAccounts();\n\t\tif (metamask_provider == false || accounts.length == 0) {\n\t\t\tthis.setState({ metamask: false });\n\t\t} else {\n\t\t\tthis.setState({ metamask: true, uploading: true });\n\t\t\tipfs.files.add(this.state.buffer, async (error, result) => {\n\t\t\t\tif (error) {\n\t\t\t\t\tconsole.error(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tawait PostFactory.methods\n\t\t\t\t\t.createPost(result[0].hash, this.state.content)\n\t\t\t\t\t.send({ from: accounts[0] });\n\t\t\t\tconst posts = await PostFactory.methods.getPosts().call();\n\t\t\t\tlet new_posts = await (async function (posts) {\n\t\t\t\t\tlet new_posts = [];\n\t\t\t\t\tfor (let i = 0; i < posts.length; i++) {\n\t\t\t\t\t\tconst Post = new web3.eth.Contract(\n\t\t\t\t\t\t\tJSON.parse(PostContract.interface),\n\t\t\t\t\t\t\tposts[i]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst currentPost = {\n\t\t\t\t\t\t\timageUrl: await Post.methods.image_hash().call(),\n\t\t\t\t\t\t\tauthor: await Post.methods.author().call(),\n\t\t\t\t\t\t\tcontent: await Post.methods.content().call(),\n\t\t\t\t\t\t\tcomments: await Post.methods.getComments().call(),\n\t\t\t\t\t\t};\n\t\t\t\t\t\tnew_posts.push(currentPost);\n\t\t\t\t\t}\n\t\t\t\t\treturn new_posts;\n\t\t\t\t})(posts);\n\t\t\t\tthis.setState({\n\t\t\t\t\tposts: new_posts,\n\t\t\t\t\tcontent: \"\",\n\t\t\t\t\tuploading: false,\n\t\t\t\t});\n\t\t\t\tconst file_uploader = document.getElementById(\"file_upload\");\n\t\t\t\tfile_uploader.value = \"\";\n\t\t\t});\n\t\t}\n\t};\n\n\timageZoom = async (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tif (this.state.zoomed !== null) {\n\t\t\tthis.setState({ zoomed: null });\n\t\t} else {\n\t\t\tthis.setState({ zoomed: event.target.getAttribute(\"src\") });\n\t\t}\n\t};\n\n\treadContent = (event) => {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tthis.setState({ content: event.target.value });\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"row\" style={{}}>\n\t\t\t\t<Head>\n\t\t\t\t\t<title>DOSN</title>\n\t\t\t\t\t<link\n\t\t\t\t\t\thref=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\"\n\t\t\t\t\t\trel=\"stylesheet\"\n\t\t\t\t\t\tintegrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></link>\n\t\t\t\t\t<link\n\t\t\t\t\t\trel=\"stylesheet\"\n\t\t\t\t\t\thref=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\"\n\t\t\t\t\t></link>\n\t\t\t\t\t<script\n\t\t\t\t\t\tsrc=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\"\n\t\t\t\t\t\tintegrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></script>\n\t\t\t\t\t<script\n\t\t\t\t\t\tsrc=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\"\n\t\t\t\t\t\tintegrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\"\n\t\t\t\t\t\tcrossorigin=\"anonymous\"\n\t\t\t\t\t></script>\n\t\t\t\t\t<script src=\"https://cdn.jsdelivr.net/npm/jdenticon@2.2.0\"></script>\n\t\t\t\t</Head>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"col-lg-3\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tposition: \"relative\",\n\t\t\t\t\t\ttextAlign: \"right\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Navbar />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"container col-lg-9\">\n\t\t\t\t\t{this.state.is_donate == true && (\n\t\t\t\t\t\t<DonateCard\n\t\t\t\t\t\t\tmin_tip={this.state.min_tip}\n\t\t\t\t\t\t\tisdonatebuttonon={this.isdonatebuttonon}\n\t\t\t\t\t\t\ttakeback={this.takeback}\n\t\t\t\t\t\t\ttransact={this.transact}\n\t\t\t\t\t\t\tdisable_transact_okay={\n\t\t\t\t\t\t\t\tthis.state.disable_transact_okay\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdonating={this.state.donating}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{this.state.metamask == false && (\n\t\t\t\t\t\t<MetamaskCard takeback={this.takeback} />\n\t\t\t\t\t)}\n\t\t\t\t\t{this.state.loading != this.state.posts.length && (\n\t\t\t\t\t\t<LoadingCard />\n\t\t\t\t\t)}\n\t\t\t\t\t{this.state.zoomed !== null && (\n\t\t\t\t\t\t<ZoomedImage\n\t\t\t\t\t\t\tzoomed={this.state.zoomed}\n\t\t\t\t\t\t\timageZoom={this.imageZoom}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<TweetForm\n\t\t\t\t\t\tcontent={this.state.content}\n\t\t\t\t\t\tuploading={this.state.uploading}\n\t\t\t\t\t\tsubmit={this.onSubmit}\n\t\t\t\t\t\treadContent={this.readContent}\n\t\t\t\t\t\tcaptureFile={this.captureFile}\n\t\t\t\t\t/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{this.state.posts\n\t\t\t\t\t\t\t.slice(0)\n\t\t\t\t\t\t\t.reverse()\n\t\t\t\t\t\t\t.map((post, index) => (\n\t\t\t\t\t\t\t\t<TweetCard\n\t\t\t\t\t\t\t\t\tpostLength={this.state.posts.length}\n\t\t\t\t\t\t\t\t\tpost={post}\n\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\timageZoom={this.imageZoom}\n\t\t\t\t\t\t\t\t\tdonate={this.donate}\n\t\t\t\t\t\t\t\t\tcommentHide={this.commentHide}\n\t\t\t\t\t\t\t\t\tpostComment={this.postComment}\n\t\t\t\t\t\t\t\t\treadContent={this.readContent}\n\t\t\t\t\t\t\t\t\tcontent={this.state.content}\n\t\t\t\t\t\t\t\t\tcaptureFile={this.captureFile}\n\t\t\t\t\t\t\t\t\tuploading={this.state.uploading}\n\t\t\t\t\t\t\t\t\tkey={index}\n\t\t\t\t\t\t\t\t\timageLoaded={this.imageLoaded}\n\t\t\t\t\t\t\t\t\tisLoaded={this.isLoaded}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\nexport default PostIndex;\n"]},"metadata":{},"sourceType":"module"}